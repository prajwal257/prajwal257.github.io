<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <title>Neuron.DEV</title>
</head>
<body>
    <style>
        body {
            color: #f5f5f5;
            background-color: #161616;
        }

        .hero h1 {
            font-family: Monument, Montserrat, sans-serif !important;   
        }
        .hero p {
            font-family: sans-serif;
        }

        .console {
            background-color: black;
            box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.75);
        }/*# sourceMappingURL=style.css.map */
    </style>
    <nav class="navbar fixed-top navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarTogglerDemo03" aria-controls="navbarTogglerDemo03" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <a class="navbar-brand ms-5" href="https://prajwal257.github.io/">
            <img src="./Neural_Network_Icon.svg" alt="" width="30" height="24" class="d-inline-block align-text-top">
            Neuron.DEV
          </a>
          <div class="collapse navbar-collapse" id="navbarTogglerDemo03">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
              <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="https://prajwal257.github.io/pages/blogs.html">Home</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="https://prajwal257.github.io/">Portfolio</a>
              </li>
            </ul>
            <form class="d-flex">
              <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
              <button class="btn btn-outline-success me-5" type="submit">Search</button>
            </form>
          </div>
        </div>
      </nav>
      
    <section class="hero p-5 mt-5" data-bs-spy="scroll" data-bs-target="#navbar-example3" data-bs-offset="0" tabindex="0">
        <h1 id="item-1" class="mb-4 display-4 col-md-8">
            Getting Started with Creating Machine Learning API with FastAPI and Jupyter Notebook
        </h1>
        <figcaption class="blockquote-footer mt-4 text-light mb-3">
            Prajwal Dwivedi. 21 March 2023. 22:00 PM
        </figcaption>
        <ul class="d-flex gap-3 me-5 list-unstyled">
            <li>
                <a href="https://www.linkedin.com/in/prajwal-dwivedi-20562b205/">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-linkedin" viewBox="0 0 16 16">
                        <path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"/>
                    </svg>
                </a>
            </li>
            <li>
                <a href="https://github.com/prajwal257">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-github" viewBox="0 0 16 16">
                        <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
                    </svg>
                </a>
            </li>
            <li>
                <a href="https://mailto:prajwal.dwivedi.official@gmail.com">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-mailbox2" viewBox="0 0 16 16">
                        <path d="M9 8.5h2.793l.853.854A.5.5 0 0 0 13 9.5h1a.5.5 0 0 0 .5-.5V8a.5.5 0 0 0-.5-.5H9v1z"/>
                        <path d="M12 3H4a4 4 0 0 0-4 4v6a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1V7a4 4 0 0 0-4-4zM8 7a3.99 3.99 0 0 0-1.354-3H12a3 3 0 0 1 3 3v6H8V7zm-3.415.157C4.42 7.087 4.218 7 4 7c-.218 0-.42.086-.585.157C3.164 7.264 3 7.334 3 7a1 1 0 0 1 2 0c0 .334-.164.264-.415.157z"/>
                    </svg>
                </a>
            </li>
        </ul>
        <img src="https://images.unsplash.com/photo-1485796826113-174aa68fd81b?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1170&q=80" class="img-fluid col-md-6 col-lg-8 mt-4 mb-3" alt="">
        <div class="mb-5 mt-5">
            <button class="btn btn-primary fw-bold">LIKE</button>
            <button class="btn btn-warning fw-bold">SHARE</button>
        </div>
        <h2 id="item-1-1" class="col-md-6 col-sm-12 mb-4 lead fw-bold" >
            While Learning about Machine learning we usually start by understanding about jupyter notebooks and then how to write code inside them. What these Youtube Tutorials dont cover is how can you actually utilize the power of your newly created Machine Learning Model for actual application.
        </h2>
        <p class="col-md-6 col-sm-12 mb-4 lead">
            FastAPI is a modern, fast (high-performance) web framework for building APIs with Python 3.6+ based on standard Python type hints. It is designed to be easy to use and productive, with great performance and scalability. In this article, we will explore how to use FastAPI to create a Machine Learning API from a model created with Jupyter Notebook, utilizing the Pickle framework in the process.
        </p>
        <p class="col-md-6 col-sm-12 mb-4 lead">
            Pickle is a Python library that allows you to serialize and deserialize Python objects. In other words, it allows you to save Python objects to a file and load them back into memory at a later time. This is useful for saving machine learning models that can be reused in different applications or for sharing with others.
        </p>
        <p class="col-md-6 col-sm-12 mb-4 lead">
            To get started, we will assume that you have already created a machine learning model in Jupyter Notebook and saved it to a file using the Pickle library. If you have not done this yet, you can follow these steps:
        </p>
        <p class="col-md-6 col-sm-12 mb-4 lead">
            <li class="col-md-6 col-sm-12 mb-4 lead">Train a machine learning model in Jupyter Notebook using any machine learning library such as scikit-learn, TensorFlow, or PyTorch.
            <li class="col-md-6 col-sm-12 mb-4 lead">Save the trained model to a file using the Pickle library. For example, you can use the following code to save a scikit-learn model:
        </p>
        <section class="h6 console col-md-6 col-lg-12 col-sm-12 pt-2 p-3 border-5 border-warning rounded-3 mb-4">
            <div class="titlebar col-0 p-2 mb-3 d-flex">
                <div class="btn rounded-circle bg-danger p-1 me-2"></div>
                <div class="btn rounded-circle bg-warning  p-1 me-2"></div>
                <div class="btn rounded-circle bg-success  p-1 me-2"></div>
            </div>
            <p class="text-light ms-2 mt-2">
                import pickle<br>
                # train a scikit-learn model<br>
                model = ...<br>
                # save the model to a file<br>
                with open('model.pkl', 'wb') as f:<br>
                    pickle.dump(model, f)<br>
    
            </p>
        </section>

        <p class=" col-lg-8 col-md-6 col-sm-12 mb-4 lead">
            Once you have a saved model file, you can use FastAPI to create an API that can serve predictions based on the model. Here's how:
        </p>
        <p class="col-md-6 col-sm-12 mb-4 lead">
            <li class="col-md-6 col-sm-12 mb-4 lead">Install FastAPI and Uvicorn:
        </p>

        <section class="h6 console col-md-6 col-lg-12 col-sm-12 pt-2 p-3 border-5 border-warning rounded-3 mb-4">
            <div class="titlebar col-0 p-2 mb-3 d-flex">
                <div class="btn rounded-circle bg-danger p-1 me-2"></div>
                <div class="btn rounded-circle bg-warning  p-1 me-2"></div>
                <div class="btn rounded-circle bg-success  p-1 me-2"></div>
            </div>
            <p class="text-light ms-2 mt-2">
                pip install fastapi uvicorn
            </p>
        </section>

        <p class=" col-lg-8 col-md-6 col-sm-12 mb-4 lead">
            Create a new Python file called `app.py` and add the following code:
        </p>
        <p class="col-md-6 col-sm-12 mb-4 lead">
            <li class="col-md-6 col-sm-12 mb-4 lead">Install FastAPI and Uvicorn:
        </p>

        <section class="h6 console col-md-12 col-lg-12 col-sm-12 pt-2 p-3 border-5 border-warning rounded-3 mb-4">
            <div class="titlebar col-0 p-2 mb-3 d-flex">
                <div class="btn rounded-circle bg-danger p-1 me-2"></div>
                <div class="btn rounded-circle bg-warning  p-1 me-2"></div>
                <div class="btn rounded-circle bg-success  p-1 me-2"></div>
            </div>
            <code class="text-light ms-2 mt-2">
                import pickle<br>
                from fastapi import FastAPI<br>

                # load the model from the file<br>
                with open('model.pkl', 'rb') as f:<br>
                    model = pickle.load(f)<br>

                # create a FastAPI instance<br>
                app = FastAPI()<br>

                # define a predict endpoint<br>
                @app.post("/predict")<br>
                async def predict(data: dict):<br>
                    # convert the data to the format expected by the model<br>
                    # for example, if the model expects a numpy array, you can use:<br>
                    # data_array = np.array(list(data.values())).reshape(1, -1)<br>

                    # make a prediction using the model<br>
                    prediction = model.predict(data_array)<br>

                    # return the prediction<br>
                    return {"prediction": prediction.tolist()}<br>
            </code>
        </section>
        
        <p class="col-md-6 col-sm-12 mb-4 lead">
            <li class="col-md-6 col-sm-12 mb-4 lead">Start the API using Uvicorn::
        </p>

        <section class="h6 console col-md-12 col-lg-12 col-sm-12 pt-2 p-3 border-5 border-warning rounded-3 mb-4">
            <div class="titlebar col-0 p-2 mb-3 d-flex">
                <div class="btn rounded-circle bg-danger p-1 me-2"></div>
                <div class="btn rounded-circle bg-warning  p-1 me-2"></div>
                <div class="btn rounded-circle bg-success  p-1 me-2"></div>
            </div>
            <code class="text-light ms-2 mt-2">
                uvicorn app:app --reload<br>
            </code>
        </section>

        <p class=" col-lg-8 col-md-6 col-sm-12 mb-4 lead">
            This will start a development server that listens for incoming requests on `http://localhost:8000`.
        </p>
        <p class="col-md-6 col-sm-12 mb-4 lead">
            <li class="col-md-6 col-sm-12 mb-4 lead">Test the API using a tool such as `curl` or Postman. For example, you can send a POST request with JSON data to the `/predict` endpoint:
        </p>

        <section class="h6 console col-md-12 col-lg-12 col-sm-12 pt-2 p-3 border-5 border-warning rounded-3 mb-4">
            <div class="titlebar col-0 p-2 mb-3 d-flex">
                <div class="btn rounded-circle bg-danger p-1 me-2"></div>
                <div class="btn rounded-circle bg-warning  p-1 me-2"></div>
                <div class="btn rounded-circle bg-success  p-1 me-2"></div>
            </div>
            <code class="text-light ms-2 mt-2">
                curl -X POST \<br>
                http://localhost:8000/predict \<br>
                -H 'Content-Type: application/json' \<br>
                -d '{<br>
                        "feature1": 1.2,<br>
                        "feature2": 3.4,<br>
                        "feature3": 5.6<br>
                    }'<br>
            </code>
        </section>

        <p class=" col-lg-8 col-md-6 col-sm-12 mb-4 lead">
            This should return a JSON response with the prediction:
        </p>

        <section class="h6 console col-md-12 col-lg-12 col-sm-12 pt-2 p-3 border-5 border-warning rounded-3 mb-4">
            <div class="titlebar col-0 p-2 mb-3 d-flex">
                <div class="btn rounded-circle bg-danger p-1 me-2"></div>
                <div class="btn rounded-circle bg-warning  p-1 me-2"></div>
                <div class="btn rounded-circle bg-success  p-1 me-2"></div>
            </div>
            <code class="text-light ms-2 mt-2">
                {<br>
                    "prediction": [0.5]<br>
                }<br>
            </code>
        </section>

        <p class=" col-lg-8 col-md-6 col-sm-12 mb-4 lead">
            In this example, we assumed that the model expects a dictionary of features as input and returns a single prediction as output. However, you may need to modify the code to fit the specific requirements of your model.
        </p>
        <h2 class="col-lg-12 col-md-6 col-sm-12 mb-4 lead fw-bold" >
            In conclusion, FastAPI is a powerful and easy-to-use web framework that allows you to create machine learning APIs from models created in Jupyter Notebook. By utilizing the Pickle library, you can easily load and serve the trained models. With FastAPI, you can create endpoints that receive input data and return predictions, which makes it simple to build scalable and high-performance APIs for your machine learning models.
        </h2>
    </section>
    <footer class="container-fluid pt-5 pb-3">
        <div class="d-lg-flex justify-content-between">
            <a class="navbar-brand ms-5" href="#">
                <img src="./Neural_Network_Icon.svg" alt="" width="30" height="24" class="d-inline-block align-text-top">
                Neuron.DEV
              </a>
            <div class="copyright">
                <p>Developed and maintained by <a href="#" target="_blank">Prajwal Dwivedi</a></p>
            </div>
            <div>
                <ul class="d-flex gap-4 me-5 list-unstyled">
                    <li>
                        <a href="https://www.linkedin.com/in/prajwal-dwivedi-20562b205/">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-linkedin" viewBox="0 0 16 16">
                                <path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"/>
                            </svg>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/prajwal257">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-github" viewBox="0 0 16 16">
                                <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
                            </svg>
                        </a>
                    </li>
                    <li>
                        <a href="https://mailto:prajwal.dwivedi.official@gmail.com">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-mailbox2" viewBox="0 0 16 16">
                                <path d="M9 8.5h2.793l.853.854A.5.5 0 0 0 13 9.5h1a.5.5 0 0 0 .5-.5V8a.5.5 0 0 0-.5-.5H9v1z"/>
                                <path d="M12 3H4a4 4 0 0 0-4 4v6a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1V7a4 4 0 0 0-4-4zM8 7a3.99 3.99 0 0 0-1.354-3H12a3 3 0 0 1 3 3v6H8V7zm-3.415.157C4.42 7.087 4.218 7 4 7c-.218 0-.42.086-.585.157C3.164 7.264 3 7.334 3 7a1 1 0 0 1 2 0c0 .334-.164.264-.415.157z"/>
                            </svg>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </footer>
</body>
</html>